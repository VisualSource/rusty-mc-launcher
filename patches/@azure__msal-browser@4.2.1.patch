diff --git a/dist/interaction_client/PopupClient.mjs b/dist/interaction_client/PopupClient.mjs
index a268fac3a1743acb01345cbd08dc176aafa8e79a..49c970cda1e17d811bceae2a3c31207fd22283de 100644
--- a/dist/interaction_client/PopupClient.mjs
+++ b/dist/interaction_client/PopupClient.mjs
@@ -1,5 +1,6 @@
 /*! @azure/msal-browser v4.2.1 2025-02-11 */
 'use strict';
+import { once } from "@tauri-apps/api/event";
 import { OIDC_DEFAULT_SCOPES, invokeAsync, PerformanceEvents, invoke, ThrottlingUtils, ProtocolUtils, AuthError, ProtocolMode, UrlString, ServerResponseType } from '@azure/msal-common/browser';
 import { StandardInteractionClient } from './StandardInteractionClient.mjs';
 import { EventType } from '../event/EventType.mjs';
@@ -272,46 +273,59 @@ class PopupClient extends StandardInteractionClient {
      * @param timeout - timeout for processing hash once popup is redirected back to application
      */
     monitorPopupForHash(popupWindow, popupWindowParent) {
-        return new Promise((resolve, reject) => {
-            this.logger.verbose("PopupHandler.monitorPopupForHash - polling started");
-            const intervalId = setInterval(() => {
-                // Window is closed
-                if (popupWindow.closed) {
-                    this.logger.error("PopupHandler.monitorPopupForHash - window closed");
-                    clearInterval(intervalId);
-                    reject(createBrowserAuthError(userCancelled));
-                    return;
-                }
-                let href = "";
-                try {
-                    /*
-                     * Will throw if cross origin,
-                     * which should be caught and ignored
-                     * since we need the interval to keep running while on STS UI.
-                     */
-                    href = popupWindow.location.href;
-                }
-                catch (e) { }
-                // Don't process blank pages or cross domain
-                if (!href || href === "about:blank") {
-                    return;
-                }
-                clearInterval(intervalId);
-                let responseString = "";
-                const responseType = this.config.auth.OIDCOptions.serverResponseType;
-                if (popupWindow) {
-                    if (responseType === ServerResponseType.QUERY) {
-                        responseString = popupWindow.location.search;
-                    }
-                    else {
-                        responseString = popupWindow.location.hash;
-                    }
-                }
-                this.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller");
-                resolve(responseString);
-            }, this.config.system.pollIntervalMilliseconds);
-        }).finally(() => {
-            this.cleanPopup(popupWindow, popupWindowParent);
+        let unlisten;
+        let intervalId;
+        
+        const hashHandler = new Promise((resolve, reject) => {
+            unlisten = once("auth-response", (ev) => {
+        	clearInterval(intervalId);
+        	try {
+        		if (typeof ev.payload === "string") {
+        			this.logger.verbose(
+        				"PopupHandler.monitorPopupForHash - popup window is on same origin as caller",
+        			);
+        
+        			const url = new URL(ev.payload);
+        			const responseType =
+        							this.config.auth.OIDCOptions.serverResponseType;
+        						let responseString = "";
+        						if (responseType === ServerResponseType.QUERY) {
+        							responseString = url.search;
+        						} else {
+        							responseString = url.hash;
+        						}
+        
+        						resolve(responseString);
+        						return;
+        					}
+        					throw new Error("Invalid payload");
+        				} catch (error) {
+        					reject(
+        						createBrowserAuthError(BrowserAuthErrorCodes.popupWindowError),
+        					);
+        				}
+        			});
+        		});
+        
+        const closeHandler = new Promise((_, reject) => {
+        	intervalId = setInterval(() => {
+        	// Window is closed
+        	if (popupWindow.closed) {
+        		this.logger.error("PopupHandler.monitorPopupForHash - window closed");
+        		clearInterval(intervalId);
+        		reject(createBrowserAuthError(BrowserAuthErrorCodes.userCancelled));
+        		return;
+        	}
+        	}, this.config.system.pollIntervalMilliseconds);
+        });
+        return Promise.race([hashHandler, closeHandler]).finally(() => {
+        	clearInterval(intervalId);
+        	this.cleanPopup(popupWindow, popupWindowParent);
+        	unlisten
+        		?.then((unsubscribe) => unsubscribe())
+        		.catch((e) =>
+        			this.logger.error(e?.message ?? "Failed to unsubscribe."),
+        		);
         });
     }
     /**
diff --git a/package.json b/package.json
index 2becc1a3eca4f514a9dfdd216215f822d69a8a8b..15bacc857922941f321de170db19d9c6d68ee4bd 100644
--- a/package.json
+++ b/package.json
@@ -103,6 +103,7 @@
     "typescript": "^4.9.5"
   },
   "dependencies": {
-    "@azure/msal-common": "15.1.1"
+    "@azure/msal-common": "15.1.1",
+    "@tauri-apps/api": "^2.2.0"
   }
 }
